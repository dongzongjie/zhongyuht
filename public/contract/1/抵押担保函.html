<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="generator" content="Aspose.Words for .NET 15.1.0.0" />
    <title></title>
    <style>
        body {
            margin: 0;
            padding: 0;
        }
        
        .docpe {
            width: 794px;
            background-color: #fff;
            padding: 60px 107px 220px;
            box-sizing: border-box;
        }
        
        button {
            position: fixed;
            top: 100px;
            left: 0;
        }
        
        #bt {
            position: fixed;
            top: 150px;
            left: 0;
        }
    </style>
    <script src="https://cdn.bootcss.com/html2canvas/0.5.0-beta4/html2canvas.js"></script>
    <script src="https://cdn.bootcss.com/jspdf/1.3.4/jspdf.debug.js"></script>
</head>

<body>
    <button onclick="printOut('抵押担保函')">点击下载合同</button>
    <button id="bt">点击打印</button>
    <div class="docpe" id="PDF">
        <div>
            <p style="line-height:33.7pt; margin:0pt 158.25pt 0pt 163.2pt; orphans:0; text-align:center; widows:0"><span style="font-family:'Microsoft JhengHei'; font-size:22pt; font-weight:bold">抵押担保函</span><span style="font-family:'Microsoft JhengHei'; font-size:22pt; font-weight:bold"> </span></p>
            <p style="margin:8.6pt 0pt 0pt 6pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:12pt">中豫融资租赁</span><span style="font-family:宋体; font-size:12pt">有限公司： </span>
            </p>
            <p style="margin:0.05pt 0pt 0pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:9.5pt">&#xa0;</span>
            </p>
            <p style="font-size:12pt; line-height:101%; margin:0pt 19.1pt 0pt 6pt; orphans:0; text-align:justify; text-indent:23.95pt; widows:0">
                <span style="font-family:宋体; font-size:12pt">以下借款人向我司购车，经由我司向贵司推荐后，由贵司为其提供借款服务且已经通过贵司审批。按照流程，贵司应当在借款人车辆抵押至贵司或贵司指定</span><span style="font-family:宋体; font-size:12pt">第三方</span><span style="font-family:宋体; font-size:12pt">名下后，发起放款。
        </span>
            </p>
            <p style="font-size:12pt; line-height:101%; margin:0.2pt 19.15pt 0pt 6pt; orphans:0; text-indent:23.95pt; widows:0">
                <span style="font-family:宋体; font-size:12pt; letter-spacing:-0.05pt">现为拓展贵我双方的合作规模并提高合作效率，我司特申请在抵押完成前放款。我司保证在借款人所购车辆按本协议完成抵押前，我司不得向借款人交付车辆，否则，我司将对该等借款人所负之债务承担即时的连带清偿责任，清</span><span style="font-family:宋体; font-size:12pt">偿范围包括但不限于借款服务合同项下的本金及利息、逾期利息、罚息、复</span>
                <span style="font-family:宋体; font-size:12pt; letter-spacing:-0.05pt">利、违约金、损害赔偿金、贵司实现在借款服务合同和抵押合同下的债权和抵</span><span style="font-family:宋体; font-size:12pt">押权时所发生的费用（包括律师费用、差旅费用、诉讼费用及其他费用）</span><span style="font-family:宋体; font-size:12pt; letter-spacing:-0.45pt">以及</span>
                <span style="font-family:宋体; font-size:12pt">其他应付款项。 </span>
            </p>
            <p style="font-size:12pt; line-height:101%; margin:0.55pt 19.25pt 0pt 6pt; orphans:0; text-indent:23.95pt; widows:0">
                <span style="font-family:宋体; font-size:12pt">同时，我司承诺，因我司暂押车辆导致的消费纠纷，与贵司无关，产生的任何责任亦由我司承担，造成贵司损失的我司应当予以赔偿。 </span>
            </p>
            <p style="margin:0.15pt 0pt 0pt 15.95pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:12pt">&#xa0;</span></p>
            <p style="margin:0.2pt 0pt 0.25pt 15.95pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:12pt">申请放款的借款人名单： </span></p>
            <table cellspacing="0" cellpadding="0" style="border-collapse:collapse; margin-left:6.25pt">
                <tr style="height:15.55pt">
                    <td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; vertical-align:top; width:137.5pt">
                        <p style="line-height:14.6pt; margin:0pt 56.3pt 0pt 55.45pt; orphans:0; text-align:center; widows:0"><span style="font-family:宋体; font-size:12pt">姓名 </span></p>
                    </td>
                    <td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; vertical-align:top; width:137.5pt">
                        <p style="line-height:14.6pt; margin:0pt 0pt 0pt 41.4pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:12pt">身份证号 </span></p>
                    </td>
                    <td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; vertical-align:top; width:137.65pt">
                        <p style="line-height:14.6pt; margin:0pt 0pt 0pt 29.4pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:12pt">放款金额 </span></p>
                    </td>
                </tr>
                <tr style="height:15.55pt">
                    <td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; vertical-align:top; width:137.5pt">
                        <p style="line-height:14.6pt; margin:0pt 0pt 0pt 5.35pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:12pt" class="name">&#xa0;</span></p>
                    </td>
                    <td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; vertical-align:top; width:137.5pt">
                        <p style="line-height:14.6pt; margin:0pt 0pt 0pt 5.4pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:12pt" class="idCard">&#xa0;</span></p>
                    </td>
                    <td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; vertical-align:top; width:137.65pt">
                        <p style="line-height:14.6pt; margin:0pt 0pt 0pt 5.4pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:12pt" class="fkje">&#xa0;</span></p>
                    </td>
                </tr>
                <tr style="height:15.65pt">
                    <td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; vertical-align:top; width:137.5pt">
                        <p style="line-height:14.7pt; margin:0pt 0pt 0pt 5.35pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:12pt">&#xa0;</span></p>
                    </td>
                    <td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; vertical-align:top; width:137.5pt">
                        <p style="line-height:14.7pt; margin:0pt 0pt 0pt 5.4pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:12pt">&#xa0;</span></p>
                    </td>
                    <td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; vertical-align:top; width:137.65pt">
                        <p style="line-height:14.7pt; margin:0pt 0pt 0pt 5.4pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:12pt">&#xa0;</span></p>
                    </td>
                </tr>
            </table>
            <p style="margin:0pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:10pt">&#xa0;</span></p>
            <p style="margin:0pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:10pt">&#xa0;</span></p>
            <p style="margin:0pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:10pt">&#xa0;</span></p>
            <p style="margin:0pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:10pt">&#xa0;</span></p>
        </div><br style="clear:both; page-break-before:auto" />
        <div>
            <p style="margin:0pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:12pt">&#xa0;</span></p>
            <p style="margin:0pt; orphans:0; text-indent:234.2pt; widows:0"><span style="font-family:宋体; font-size:12pt">签字</span><span style="font-family:宋体; font-size:12pt">（公章）</span><span style="font-family:宋体; font-size:12pt">：</span><span style="font-family:宋体; font-size:12pt"> </span></p>
            <p style="margin:0pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:12pt">&#xa0;</span></p>
            <p style="margin:0pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:12pt">&#xa0;</span></p>
            <p style="margin:0.1pt 0pt 0pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:9.5pt">&#xa0;</span>
            </p>
            <p style="margin:0pt 0pt 0pt 9.7pt; orphans:0; text-indent:187pt; widows:0"><span style="font-family:宋体; font-size:12pt">日 期 ：</span><span style="font-family:宋体; font-size:12pt" class="nian">
        </span><span style="font-family:宋体; font-size:12pt">年 </span><span style="font-family:宋体; font-size:12pt" class="yue"> 
        </span><span style="font-family:宋体; font-size:12pt">月 </span>
                <span style="font-family:宋体; font-size:12pt" class="ri">  </span><span style="font-family:宋体; font-size:12pt">日
        </span><br style=" clear:both" /></p>
            <p style="margin:0.25pt 0pt 0pt; orphans:0; widows:0"><span style="font-family:宋体; font-size:12pt">&#xa0;</span>
            </p>
        </div>
    </div>
</body>
<script>
    // 接收VUE数据
    window.addEventListener("message", function(event) {
        // console.log(event);
        var date = new Date()
        let name = document.querySelector('.name')
        let idCard = document.querySelector('.idCard')
        let fkje = document.querySelector('.fkje')
        let nian = document.querySelector('.nian')
        let yue = document.querySelector('.yue')
        let ri = document.querySelector('.ri')
        name.innerHTML = event.data.borrower.userName
        idCard.innerHTML = event.data.borrower.idCard
        if (event.data.carLoan) {
            fkje.innerHTML = event.data.carLoan.loanAmount + '元'
        }
        nian.innerHTML = date.getFullYear()
        yue.innerHTML = date.getMonth() + 1
        ri.innerHTML = date.getDate()
        if (event.data.isDownload) return printOut('抵押担保函')
        if (event.data.isPrint) return printdiv(div_print)
    })

    // PDF
    function printOut(name) {
        let shareContent = document.querySelector('#PDF'), //需要截图的包裹的（原生的）DOM 对象
            width = shareContent.clientWidth, //获取dom 宽度
            height = shareContent.clientHeight, //获取dom 高度
            canvas = document.createElement("canvas"), //创建一个canvas节点
            scale = 2; //定义任意放大倍数 支持小数
        canvas.width = width * scale; //定义canvas 宽度 * 缩放
        canvas.height = height * scale; //定义canvas高度 *缩放
        canvas.style.width = shareContent.clientWidth * scale + "px";
        canvas.style.height = shareContent.clientHeight * scale + "px";
        canvas.getContext("2d").scale(scale, scale); //获取context,设置scale
        let opts = {
            scale: scale, // 添加的scale 参数
            canvas: canvas, //自定义 canvas
            logging: false, //日志开关，便于查看html2canvas的内部执行流程
            width: width, //dom 原始宽度
            height: height,
            useCORS: true, // 【重要】开启跨域配置
        };

        html2canvas(shareContent, opts).then(() => {
            var contentWidth = canvas.width;
            var contentHeight = canvas.height;
            //一页pdf显示html页面生成的canvas高度;
            var pageHeight = (contentWidth / 592.28) * 841.89;
            //未生成pdf的html页面高度
            var leftHeight = contentHeight;
            //页面偏移
            var position = 0;
            //a4纸的尺寸[595.28,841.89]，html页面生成的canvas在pdf中图片的宽高
            var imgWidth = 595.28;
            var imgHeight = (592.28 / contentWidth) * contentHeight;
            var pageData = canvas.toDataURL("image/jpeg", 1.0);
            var PDF = new jsPDF("", "pt", "a4");
            if (leftHeight < pageHeight) {
                PDF.addImage(pageData, "JPEG", 0, 0, imgWidth, imgHeight);
            } else {
                while (leftHeight > 0) {
                    PDF.addImage(pageData, "JPEG", 0, position, imgWidth, imgHeight);
                    leftHeight -= pageHeight;
                    position -= 841.89;
                    if (leftHeight > 0) {
                        PDF.addPage();
                    }
                }
            }
            PDF.save(name + ".pdf"); // 这里是导出的文件名
        });
    }

    // 打印
    function printdiv(printpage) {
        var newstr = printpage.innerHTML;
        var oldstr = document.body.innerHTML;
        document.body.innerHTML = newstr;
        window.print();
        document.body.innerHTML = oldstr;
        return false;
    }
    var bt = document.getElementById("bt");
    var div_print = document.getElementById("PDF");
    bt.onclick = function() {
        printdiv(div_print);
    }
</script>

</html>